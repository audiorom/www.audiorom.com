#!/usr/local/bin/perl#**********************************************************************#* Program:      Hyperthread-LITE from Radiation                      *#* Module:       Discussion System                                    *#* Version:      1.0                                                  *#* Author:       Andrew Cowan (icculus@radiation.com) for Radiation   *#* Date:         January 7, 1997                                      *#* Product Info: http://www.radiation.com/gizmos/htlite.html          *#*                                                                    *#* This program is the copyrighted property of Radiation, a venture   *#* of GlobalMedia Design. Any use of this program is subject to the   *#* the terms of the license agreement (LICENSE.TXT) included as part  *#* of this distribution archive. Any other uses are stictly           *#* prohibited without the written permission of GlobalMedia Design    *#* and all other rights are reserved.                                 *#*                                                                    *#* Support for this software is available only to registered users.   *#* For registration information, consult the REGISTER.TXT document    *#* included as part of this distribution archive, or visit the Gizmos *#* section of the Radiation website at:                               *#*                                                                    *#*                http://www.radiation.com/gizmos/                    *#*                                                                    *#**********************************************************************# ************************************************************************# Module Requirements Section # ************************************************************************require 'radthread-utils.pl';require 'radthread-msgs.pl';require 'radthread-search.pl';require 'radthread-help.pl';require 'radthread-headers.pl';# ************************************************************************# Main Routine# ************************************************************************print "Content-type: text/html \n\n";  # Send content type to browser&cgiparse;              # Parse the form fields (if any)&startup;               # Assign variables from the form fields&get_date;              # Get the date and convert from military format &load_areas;            # Load the areas list from the databaseif ($mode eq "AREA"){                 # User just selected an area to go to   &interpret;}elsif ($mode eq "MSG"){              # User selected a message to read   &display_message($area, $message); }elsif ($mode eq "POST"){             # User Selected Post Message to Area   &post_form($area, "NEW"); }elsif ($mode eq "REPLY"){            # User Selected Reply to Message   &post_form($area, "REPLY"); }elsif ($mode eq "NEW_POST"){         # User completed post message form   &post_handler($area, "NEW");     }elsif ($mode eq "REPLY_POST"){       # User completed post reply form   &post_handler($area, "REPLY");     }elsif ($mode eq "SFORM"){            # User requested search form   &search_form;}elsif ($mode eq "SEARCH"){           # User completed search form   &search; }elsif ($mode eq "HELP"){             # User requested help    &help;}elsif (($mode eq "") || ($mode eq "TOP")){ # Send main menu of areas   &interpret;}exit(0);                # Time to go to bed# ************************************************************************# Subroutines Section# ************************************************************************# ************************************************************************# Startup - Assign form fields to variables# ************************************************************************sub startup{   $mode = $elements{'mode'};   $area = "general";   $message = $elements{'message'};   $name = $elements{'name'};   $email = $elements{'email'};   $subject = $elements{'subject'};   $message_body = $elements{'message_body'};   $keyword = $elements{'keyword'};   $maxhits = $elements{'maxhits'};   $segment = $elements{'segment'};   $back = $elements{'back'};   $id = $elements{'id'};   $pwd = $elements{'pwd'};}# ************************************************************************# Urldecode Routines# ************************************************************************# Copyright & Disclaimer. (James Tappin)#       This set of routines may be freely distributed, modified and#       used, provided this copyright & disclaimer remains intact.#       This package is used at your own risk, if it does what you#       want, good; if it doesn't, modify it or use something else--but#       don't blame me. Support level = negligable (i.e. mail bugs but#       not requests for extensions)# ************************************************************************sub cgiparse {  if ($ENV{'REQUEST_METHOD'} eq "POST") {	read(STDIN, $data, $ENV{'CONTENT_LENGTH'});  }  elsif ($ENV{'REQUEST_METHOD'} eq "GET") {	$data = $ENV{'QUERY_STRING'};  }  else {	#	#  Bad request method report and exit.	#	&method_error;  }  %elements = &url_decode(split(/[&=]/,$data));  %elements;}sub method_error {  print "\nCGI Script Requires use of method POST or GET.\n";  exit;}sub url_decode {    foreach (@_) {        tr/+/ /;        s/%(..)/pack("c",hex($1))/ge;    }    @_;}# ************************************************************************# End of Radiation Hyperthread (Main Module)# ************************************************************************